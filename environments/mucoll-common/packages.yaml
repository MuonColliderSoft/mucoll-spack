packages:
  all:
    target: [x86_64, aarch64]
    variants: build_type=Release cxxstd=20
    buildable: true

  # Use the system OpenGL as recommended by spack
  # See https://github.com/key4hep/key4hep-spack/issues/318 and
  # https://github.com/key4hep/key4hep-spack/issues/516
  # A version is needed and we set it to 99 so that spack thinks it's the latest
  # (it may not work if the versions in the current system are not what's required
  # but that hasn't happened yet)
  opengl:
    buildable: False
    externals:
    - spec: opengl@99
      prefix: /usr
  openglu:
    buildable: False
    externals:
    - spec: openglu@99
      prefix: /usr
  mesa:
    buildable: False
    externals:
    - spec: mesa@99
      prefix: /usr
  mesa-glu:
    buildable: False
    externals:
    - spec: mesa-glu@99
      prefix: /usr
 # Use the system kerberos, otherwise the tickets obtained at login with the
  # system version don't appear for the spack kerberos (happening on lxplus at least)
  krb5:
    buildable: False
    externals:
    - spec: krb5@99
      prefix: /usr
  # Use the system ssh, otherwise the configuration for the provided ssh will likely be
  # different and things like ssh using kerberos won't work (by extension authentication
  # for git with ssh with kerberos)
  openssh:
    buildable: False
    externals:
    - spec: openssh@99
      prefix: /usr

  # needed by Alma9 to support AVX2 instructions
  binutils:
    require: +gas
  gdb:
    require: +python+tui+source-highlight~debuginfod
  py-pandas:
    require: ~excel~parquet~performance

  torch-scatter:
    require: '@copilot'

  dd4hep:
    require: '+edm4hep+lcio+xercesc+hepmc3'
  acts:
    require: '@44.1.0+dd4hep+json+gnn cxxstd=20'
  k4geo:
    require: '@0.23'
  k4gaudipandora:
    require: '@main'
  k4reco:
    require: '@main'
  k4actstracking:
    require: '@main'

  muoncvxddigitiser:
    require: '@0.2.2'
  lccontent:
    require: +monitoring

  #required to fix issue with recent Gaudi. 
  #Remove when a new tag including https://github.com/key4hep/k4FWCore/commit/1364cd8ecc7da5f0719a1c2beeb03d8a032747aa
  #is available
  k4fwcore:
    require: '@main'
